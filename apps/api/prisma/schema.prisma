generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Trainee {
  id Int @id @default(autoincrement())

  name     String
  username String @unique

  Workout   Workout[]
  OneRepMax OneRepMax[]
}

model Workout {
  id        Int @id @default(autoincrement())
  traineeId Int

  date    DateTime
  comment String?

  Trainee Trainee @relation(fields: [traineeId], references: [id])
  Set     Set[]
}

model Set {
  id          Int @id @default(autoincrement())
  workoutId   Int
  exerciseId  Int
  oneRepMaxId Int

  order     Int        @db.SmallInt
  multiple  Int        @default(1) @db.SmallInt
  reps      Int        @db.SmallInt
  weight    Int        @db.SmallInt
  unit      WeightUnit @default(kg)
  isWorkSet Boolean    @default(false)
  comment   String?

  Workout   Workout   @relation(fields: [workoutId], references: [id])
  Exercise  Exercise  @relation(fields: [exerciseId], references: [id])
  OneRepMax OneRepMax @relation(fields: [oneRepMaxId], references: [id])
}

model Exercise {
  id Int @id @default(autoincrement())

  nameCode String

  Set       Set[]
  OneRepMax OneRepMax[]
}

model OneRepMax {
  id         Int @id @default(autoincrement())
  traineeId  Int
  exerciseId Int

  value    Int        @db.SmallInt
  unit     WeightUnit @default(kg)
  starting DateTime

  Trainee  Trainee  @relation(fields: [traineeId], references: [id])
  Exercise Exercise @relation(fields: [exerciseId], references: [id])
  Set      Set[]
}

enum WeightUnit {
  kg
  lbs
}

model Locale {
  code String @id @db.Char(5)

  Translation Translation[]
}

model Translation {
  localeCode String @db.Char(5)

  code  String
  value String

  Locale Locale @relation(fields: [localeCode], references: [code])

  @@id([localeCode, code])
}
